import{m as k}from"./modalMixin-20885eca.js";import{r as c,d as h,p as L,c as I,u as V,a as w,e as N}from"./db-a6684dc1.js";import{t as v}from"./todo-fba3e443.js";import{m as x,_ as M,o as d,c as l,b as e,e as r,t as a,i as T,v as f,k as g,h as _,f as m,n as p,F as y,j as A}from"./index-037d80ef.js";const S={data(){return{tempTodo:{createdTime:new Date().getTime(),updateTime:new Date().getTime(),list:[]},editTitle:!1,message:"",todoId:"",todoNum:0,status:"new",page:"全部"}},mixins:[k],props:["uid","id","openModal"],methods:{...x(v,["toastMessage"]),addTempTodo(){this.message!==""&&(this.tempTodo.list.push({id:new Date().getTime(),checked:!1,message:this.message}),this.message="")},clearAll(){this.tempTodo.list=this.tempTodo.list.filter(i=>i.checked===!1)},updateTodo(){if(this.status==="new"){this.tempTodo.title||(this.tempTodo.title=`清單${new Date().getTime()}`);const i=c(h,`todoLists/${this.uid}/`),s=L(i);I(s,this.tempTodo),this.toastMessage("新增清單成功"),this.hide()}else this.status==="edit"&&(V(c(h),{[`todoLists/${this.uid}/${this.todoId}/title/`]:this.tempTodo.title,[`todoLists/${this.uid}/${this.todoId}/updateTime/`]:new Date().getTime(),[`todoLists/${this.uid}/${this.todoId}/list/`]:this.tempTodo.list}),this.toastMessage("修改清單成功"),this.hide())}},mounted(){},watch:{id(){if(this.id){if(this.id==="new")this.status="new",this.tempTodo={createdTime:new Date().getTime(),updateTime:new Date().getTime(),list:[]},this.show(),this.openModal("");else if(this.id!=="new"){this.status="edit";const i=c(h,`todoLists/${this.uid}/${this.id}`);w(i,s=>{this.tempTodo=s.val(),this.tempTodo.list||(this.tempTodo.list=[]),this.show(),this.todoId=this.id,this.openModal("");const u=this.tempTodo.list.filter(b=>b.checked===!1);this.todoNum=u.length})}}},page(){this.page==="全部"?this.renderTodo=this.tempTodo.list:this.page==="待完成"?this.renderTodo=this.tempTodo.list.filter(i=>i.checked===!1):this.page==="已完成"&&(this.renderTodo=this.tempTodo.list.filter(i=>i.checked===!0))}}},j={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},B={class:"modal-dialog modal-fullscreen-md-down modal-xl"},K={class:"modal-content"},R={class:"modal-header bg-green"},U={class:"modal-title text-white",id:"exampleModalLabel"},q={key:0},F={key:1},H=e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={key:0,class:"modal-body"},E={class:"pb-5"},G={class:"container"},J={class:"mb-5"},O={key:0,class:"mb-3 col-6 d-flex",style:{margin:"0 auto"}},P=e("i",{class:"fs-4 bi bi-pencil-square"},null,-1),Q=[P],W={key:1,class:"text-center"},X=e("i",{class:"fs-4 bi bi-pencil-square"},null,-1),Y=[X],Z={class:"input-group"},$=e("i",{class:"bi bi-plus-lg"},null,-1),ee=[$],te={class:"mt-4"},se={class:"card"},oe={class:"card-header d-flex list-unstyled justify-content-evenly bg-green"},ie=e("a",{href:"#",class:"btn fs-5 fw-bold text-white border-0"},"全部",-1),de=[ie],le=e("a",{href:"#",class:"btn fs-5 fw-bold text-white border-0"},"待完成",-1),ne=[le],ae=e("a",{href:"#",class:"btn fs-5 fw-bold text-white border-0"},"已完成",-1),re=[ae],ce={class:"card-body"},he={class:"list-unstyled todoList"},me={key:0,class:"fs-5 d-flex align-items-center",style:{cursor:"pointer"}},pe={key:0,class:"checkbox"},ue={key:1,class:"check"},be=["onClick"],_e=["onClick"],Te=e("i",{class:"bi bi-x-lg"},null,-1),fe=[Te],ge={class:"card-footer d-flex justify-content-between align-items-center"},ye={class:"mb-0"},ke={class:"modal-footer"},we=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1),ve=e("span",null,"確認",-1),xe=[ve];function Me(i,s,u,b,t,n){return d(),l("div",j,[e("div",B,[e("div",K,[e("div",R,[e("h5",U,[t.status==="new"?(d(),l("span",q,"新增清單內容")):t.status==="edit"?(d(),l("span",F,"編輯清單內容")):r("",!0)]),H]),t.tempTodo?(d(),l("div",z,[e("p",null,"建立時間："+a(new Date(t.tempTodo.createdTime).toLocaleDateString())+" "+a(new Date(t.tempTodo.createdTime).getHours())+":"+a(new Date(t.tempTodo.createdTime).getMinutes()),1),e("p",null,"更新時間："+a(new Date(t.tempTodo.updateTime).toLocaleDateString())+" "+a(new Date(t.tempTodo.updateTime).getHours())+":"+a(new Date(t.tempTodo.updateTime).getMinutes()),1),e("div",E,[e("section",G,[e("div",J,[t.editTitle?(d(),l("div",O,[T(e("input",{onKeyup:s[0]||(s[0]=g(o=>t.editTitle=!1,["enter"])),type:"email",class:"form-control",id:"todoTitle","onUpdate:modelValue":s[1]||(s[1]=o=>t.tempTodo.title=o)},null,544),[[f,t.tempTodo.title]]),e("button",{type:"button",onClick:s[2]||(s[2]=o=>t.editTitle=!1),class:"btn border-0"},Q)])):r("",!0),t.editTitle?r("",!0):(d(),l("h3",W,[_(a(t.tempTodo.title?t.tempTodo.title:"清單名稱"),1),e("button",{type:"button",onClick:s[3]||(s[3]=o=>t.editTitle=!0),class:"btn border-0"},Y)]))]),e("div",Z,[T(e("input",{type:"text",onKeyup:s[4]||(s[4]=g((...o)=>n.addTempTodo&&n.addTempTodo(...o),["enter"])),class:"form-control p-3","onUpdate:modelValue":s[5]||(s[5]=o=>t.message=o),placeholder:"待辦事項"},null,544),[[f,t.message]]),e("button",{type:"button",class:"btn btn-outline-green px-3",onClick:s[6]||(s[6]=(...o)=>n.addTempTodo&&n.addTempTodo(...o))},ee)]),e("div",te,[e("div",se,[e("ul",oe,[e("li",{onClick:s[7]||(s[7]=m(o=>t.page="全部",["prevent"])),class:p({"border-bottom":t.page==="全部","border-3":t.page==="全部"}),style:{transition:"all .4s ease-out","border-bottom":"3px solid transparent"}},de,2),e("li",{onClick:s[8]||(s[8]=m(o=>t.page="待完成",["prevent"])),class:p({"border-bottom":t.page==="待完成","border-3":t.page==="待完成"}),style:{transition:"all .4s ease-out","border-bottom":"3px solid transparent"}},ne,2),e("li",{onClick:s[9]||(s[9]=m(o=>t.page="已完成",["prevent"])),class:p({"border-bottom":t.page==="已完成","border-3":t.page==="已完成"}),style:{transition:"all .4s ease-out","border-bottom":"3px solid transparent"}},re,2)]),e("div",ce,[e("ul",he,[(d(!0),l(y,null,A(t.tempTodo.list,(o,D)=>(d(),l(y,{key:o.id},[t.page==="全部"||t.page==="待完成"&&o.checked===!1||t.page==="已完成"&&o.checked===!0?(d(),l("li",me,[o.checked?o.checked?(d(),l("span",ue)):r("",!0):(d(),l("span",pe)),e("p",{onClick:C=>o.checked=!o.checked,class:p(["mb-0 w-100 py-3 border-bottom",{"text-decoration-line-through":o.checked}]),style:{"word-break":"break-all"}},a(o.message),11,be),e("a",{href:"#",class:"btn ms-auto",onClick:m(C=>t.tempTodo.list.splice(D,1),["prevent"])},fe,8,_e)])):r("",!0)],64))),128))])]),e("div",ge,[e("p",ye,a(t.tempTodo.list.filter(o=>o.checked===!1).length)+" 個待完成項目",1),e("button",{type:"button",class:"btn border-0",onClick:s[10]||(s[10]=(...o)=>n.clearAll&&n.clearAll(...o))},"清除已完成項目")])])])])])])):r("",!0),e("div",ke,[we,e("button",{type:"button",class:"btn btn-primary",onClick:s[11]||(s[11]=(...o)=>n.updateTodo&&n.updateTodo(...o))},xe)])])])],512)}const Fe=M(S,[["render",Me]]),De={data(){return{tempTodo:{},deleteId:""}},mixins:[k],props:["id","openDeleteModal","uid"],methods:{...x(v,["toastMessage"]),deleteTodo(){N(c(h,`todoLists/${this.uid}/${this.deleteId}`)),this.toastMessage("刪除清單"),this.hide()}},watch:{id(){if(this.id){const i=c(h,`todoLists/${this.uid}/${this.id}`);w(i,s=>{this.tempTodo=s.val(),this.show(),this.deleteId=this.id,this.openDeleteModal("")})}}}},Ce={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Le={class:"modal-dialog"},Ie={class:"modal-content"},Ve=e("div",{class:"modal-header bg-dark"},[e("h5",{class:"modal-title text-white",id:"exampleModalLabel"}," 刪除清單 "),e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ne={class:"modal-body"},Ae={key:0,class:"text-danger fw-bold"},Se={class:"modal-footer"},je=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function Be(i,s,u,b,t,n){return d(),l("div",Ce,[e("div",Le,[e("div",Ie,[Ve,e("div",Ne,[e("p",null,[_("確定要刪除清單 "),t.tempTodo?(d(),l("span",Ae," 【"+a(t.tempTodo.title)+"】 ",1)):r("",!0),_(" 嗎? ")])]),e("div",Se,[je,e("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...o)=>n.deleteTodo&&n.deleteTodo(...o))}," 確認刪除 ")])])])],512)}const He=M(De,[["render",Be]]);export{He as D,Fe as T};
