import{b as w,r as _,d as p,o as v,a as C,c as V,p as L,s as j,e as N}from"./utilities-57ef9193.js";import{m as S,_ as I,o,c as i,d as e,i as x,t as h,f as m,r as T,l as g,s as b,F as u,k as y,v as U,n as R,e as D,p as k,q as B,h as O}from"./index-c5b4433a.js";import{m as A}from"./modalMixin-2581eaa3.js";import{C as F,_ as K}from"./undraw_Notebook_re_id0r-714460ab.js";import"./publicData-4ff1fa50.js";const q={data(){return{schedule:{},deleteId:""}},mixins:[A],props:["id","openDeleteModal","uid","index"],methods:{...S(C,["toastMessage"]),deleteSchedule(){w(_(p,`schedules/${this.uid}/${this.deleteId}/${this.index}`)),this.toastMessage("刪除成功"),this.hide()}},watch:{id(){if(this.id){const d=_(p,`schedules/${this.uid}/${this.id}/${this.index}`);v(d,t=>{this.schedule=t.val(),this.show(),this.deleteId=this.id,this.openDeleteModal("",this.index)},{onlyOnce:!0})}}}},z={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},E={class:"modal-dialog"},G={class:"modal-content"},H=e("div",{class:"modal-header bg-dark"},[e("h5",{class:"modal-title text-white",id:"exampleModalLabel"}," 刪除行程 "),e("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),J={key:0,class:"modal-body"},P={class:"text-danger fw-bold"},Q={class:"modal-footer"},W=e("button",{type:"button",class:"btn btn-gray","data-bs-dismiss":"modal"},"關閉",-1);function X(d,t,r,n,s,a){return o(),i("div",z,[e("div",E,[e("div",G,[H,s.schedule?(o(),i("div",J,[e("p",null,[x("確定要刪除 【"+h(s.schedule.startTime)+"-"+h(s.schedule.endTime)+"】",1),e("span",P,h(s.schedule.message),1),x(" 嗎? ")])])):m("",!0),e("div",Q,[W,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...f)=>a.deleteSchedule&&a.deleteSchedule(...f))}," 確認刪除 ")])])])],512)}const Y=I(q,[["render",X]]),Z={data(){return{uid:"",scheduleId:"",startTime:"8:00",endTime:"9:00",mark:"一般",message:"",schedules:{},oneDaySchedule:{},index:"",deleteScheduleId:"",color:""}},components:{DeleteScheduleModal:Y,CalendarComponent:F},methods:{...S(C,["toastMessage","goToTop"]),...S(B,["startLoading","endLoading"]),getDateId(d){this.scheduleId=d},getColor(d){this.color=d},getSchedules(){this.startLoading(),V(N,d=>{if(d){this.uid=d.uid;const t=_(p,"schedules/"+d.uid);v(t,r=>{if(this.schedules=r.val(),this.schedules){if(this.oneDaySchedule=this.schedules[this.scheduleId],this.oneDaySchedule){for(const n in this.oneDaySchedule)this.oneDaySchedule[n].id=n;this.oneDaySchedule=Object.values(this.oneDaySchedule).sort((n,s)=>n.startTime.split(":")[0]-s.startTime.split(":")[0])}}else this.schedules={},this.oneDaySchedule={};this.endLoading()})}else this.uid=null,this.$router.push("/loginSignup"),this.toastMessage("請登入","error"),this.endLoading()})},getSchedule(d){this.scheduleId=d;const t=_(p,`schedules/${this.uid}/${this.scheduleId}`);v(t,r=>{if(this.oneDaySchedule=r.val(),!this.oneDaySchedule){this.oneDaySchedule={};return}for(const n in this.oneDaySchedule)this.oneDaySchedule[n].id=n;this.oneDaySchedule=Object.values(this.oneDaySchedule).sort((n,s)=>n.startTime.split(":")[0]-s.startTime.split(":")[0])})},addTempSchedule(){if(this.message==="")return;const d={mark:this.mark,startTime:this.startTime,endTime:this.endTime,message:this.message};this.message="";const t=_(p,`schedules/${this.uid}/${this.scheduleId}`),r=L(t);j(r,d),this.toastMessage("新增行事曆成功")},openDeleteModal(d,t){this.deleteScheduleId=d,this.index=t}},mounted(){this.goToTop(),this.getSchedules()}},$={"data-aos":"fade-up","data-aos-duration":"1000",class:"py-lg-160 py-100 container"},ee=O('<h2 class="text-center mb-4 mb-lg-5">行事曆</h2><ul class="list-unstyled d-flex justify-content-end fs-14 fs-lg-6"><li class="d-flex me-3"><div class="bg-danger" style="width:20px;height:20px;"></div><span class="ms-2">緊急</span></li><li class="d-flex me-3"><div class="bg-warning" style="width:20px;height:20px;"></div><span class="ms-2">優先</span></li><li class="d-flex"><div class="bg-success" style="width:20px;height:20px;"></div><span class="ms-2">一般</span></li></ul>',2),se={class:"row mb-3 mb-lg-4 gy-3"},te={class:"col-lg-2"},le=e("label",{for:"mark",class:"form-label"},"註記",-1),de=e("option",{value:"緊急"},"緊急",-1),oe=e("option",{value:"優先"},"優先",-1),ie=e("option",{value:"一般"},"一般",-1),ae=[de,oe,ie],ne={class:"col-lg-2"},ce=e("label",{for:"startTime",class:"form-label"},"起始時間",-1),he=["value"],re={class:"col-lg-2"},ue=e("label",{for:"endTime",class:"form-label"},"結束時間",-1),me=["value"],_e={class:"col-lg-5 col-10"},pe=e("label",{for:"work",class:"form-label"},"行程",-1),ge={class:"col-lg-1 col-2 mt-auto d-flex justify-content-end"},fe={class:"row g-4"},be={class:"col"},ye={class:"card"},ve={class:"card-body pb-0"},Se={class:"table fs-14 fs-lg-6 table-hover align-middle"},xe={class:"py-3"},Te={class:"py-3"},De={class:"py-3 word-break-all"},ke={class:"text-end py-lg-2 py-3"},Ce=["onClick"],Ie={key:0,class:"text-center pointer-events-none"},Me=e("img",{src:K,alt:"尚無紀錄"},null,-1),we=e("p",{class:"fs-6 fs-lg-4"},"尚無紀錄",-1),Ve=[Me,we],Le={key:0,class:"text-center py-5 text-muted"};function je(d,t,r,n,s,a){const f=T("CalendarComponent"),M=T("DeleteScheduleModal");return o(),i("div",$,[ee,e("div",se,[e("div",te,[le,g(e("select",{name:"",id:"mark",class:"form-select fs-lg-14","onUpdate:modelValue":t[0]||(t[0]=l=>s.mark=l)},ae,512),[[b,s.mark]])]),e("div",ne,[ce,g(e("select",{name:"",id:"startTime",class:"form-select fs-lg-14","onUpdate:modelValue":t[1]||(t[1]=l=>s.startTime=l)},[(o(),i(u,null,y(24,(l,c)=>(o(),i(u,{key:l+302},[c!==24?(o(),i("option",{key:0,value:`${c}:00`},h(`${c}:00`),9,he)):m("",!0)],64))),64))],512),[[b,s.startTime]])]),e("div",re,[ue,g(e("select",{name:"",id:"endTime",class:"form-select fs-lg-14","onUpdate:modelValue":t[2]||(t[2]=l=>s.endTime=l)},[(o(),i(u,null,y(24,(l,c)=>(o(),i(u,{key:l+302},[c!==24&&c>=s.startTime.split(":")[0]?(o(),i("option",{key:0,value:`${c}:00`},h(`${c}:00`),9,me)):m("",!0)],64))),64))],512),[[b,s.endTime]])]),e("div",_e,[pe,g(e("input",{type:"text",id:"work",class:"form-control fs-lg-14","onUpdate:modelValue":t[3]||(t[3]=l=>s.message=l),onKeyup:t[4]||(t[4]=R((...l)=>a.addTempSchedule&&a.addTempSchedule(...l),["enter"]))},null,544),[[U,s.message]])]),e("div",ge,[e("button",{onClick:t[5]||(t[5]=(...l)=>a.addTempSchedule&&a.addTempSchedule(...l)),type:"button",class:"btn btn-outline-primary ms-auto"},"+")])]),e("div",fe,[D(f,{onDataId:a.getDateId,onColor:a.getColor,data:s.schedules,"get-data":a.getSchedule},null,8,["onDataId","onColor","data","get-data"]),e("div",be,[e("div",ye,[e("div",{class:k(["card-header fs-4 text-center text-white",[`bg-${s.color}`]])},h(s.scheduleId),3),e("div",ve,[e("table",Se,[e("tbody",null,[(o(!0),i(u,null,y(s.oneDaySchedule,(l,c)=>(o(),i("tr",{key:c+4910},[e("td",xe,[e("div",{class:k({"bg-danger":l.mark==="緊急","bg-warning":l.mark==="優先","bg-success":l.mark==="一般"}),style:{width:"20px",height:"20px"}},null,2)]),e("td",Te,h(l.startTime)+"-"+h(l.endTime),1),e("td",De,h(l.message),1),e("td",ke,[e("i",{class:"bi bi-x fs-15 fs-lg-3 cursor-pointer",onClick:Ne=>a.openDeleteModal(s.scheduleId,l.id)},null,8,Ce)])]))),128)),!s.oneDaySchedule||!s.oneDaySchedule.length?(o(),i("tr",Ie,Ve)):m("",!0)])])])]),s.oneDaySchedule?m("",!0):(o(),i("h4",Le,"尚無行程安排"))])]),D(M,{id:s.deleteScheduleId,"open-delete-modal":a.openDeleteModal,uid:s.uid,index:s.index},null,8,["id","open-delete-modal","uid","index"])])}const Fe=I(Z,[["render",je]]);export{Fe as default};
